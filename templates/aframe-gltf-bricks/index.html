<head>
  <title>My A-Frame Scene</title>
  <script src="https://aframe.io/releases/1.1.0/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-gltf-part-component@1.2.0/dist/aframe-gltf-part-component.min.js"></script>

  <script>
    AFRAME.registerComponent("center", {
      init: function () {
        this.scale();
        this.el.addEventListener("object3dset", () => this.center());
      },
      center: function () {
        const el = this.el;
        const obj = el.object3D;
        const mesh = el.getObject3D("mesh");
        if (!mesh) return;
        const bbox = new THREE.Box3().setFromObject(mesh);
        const offset = bbox.getCenter();
        mesh.position.sub(offset);
        obj.position.add(offset);
      },
    });
  </script>
</head>

<body>
  <a-scene background="color: #000">
    <a-assets>
      <a-asset-item id="bricks" src="staircase.glb"></a-asset-item>
      <a-mixin id="slime" material="opacity: 0.5"></a-mixin>
      <a-mixin id="blue" material="color: #0ff;"></a-mixin>
      <a-mixin id="pink" material="color: #f0f;"></a-mixin>
      <a-mixin id="green" material="color: #0f0;"></a-mixin>
      <a-mixin
        id="blink"
        animation__1="property: material.opacity; from:0.5; to:1; dur: 200; easing: easeInOutSine; dir: alternate; loop: true"
      ></a-mixin>
      <a-mixin
        id="hover"
        animation__2="property: position; from: 0 -3 0; to: 0 -5 0; dur: 1000; easing: easeInOutSine; dir: alternate; loop: true"
      ></a-mixin>
      <a-mixin
        id="pump"
        animation__3="property: scale; from: 0.5 0.5 0.5; to: 1 1 1; dur: 500; easing: easeInOutSine; dir: alternate; loop: true"
        center
      ></a-mixin>
    </a-assets>

    <a-entity position="0 0 -10" rotation="180 0 0" scale="0.5 0.5 0.5">
      <!--  <a-entity id="model" gltf-model="#bricks"></a-entity> -->

      <!-- Parts that only occur once -->
      <a-entity
        id="door"
        gltf-part="src: #bricks; part: Part-89513_dot_dat"
        mixin="blue slime blink"
      ></a-entity>
      <a-entity
        id="key"
        gltf-part="src: #bricks; part: Part-62808_dot_dat"
        mixin="blue slime blink hover"
      ></a-entity>
      <a-entity
        id="stand"
        gltf-part="src: #bricks; part: Part-67929_dot_dat"
        mixin="green slime"
      ></a-entity>
      <a-entity
        id="staircase"
        gltf-part="src: #bricks; part: Part-40243c01_dot_dat"
        mixin="slime"
      ></a-entity>
      <a-entity
        id="platform"
        gltf-part="src: #bricks; part: Part-6179_dot_dat"
        mixin="pink slime"
      ></a-entity>

      <!-- Parts that occur multiple times  -->

      <!-- 12 cylindrical bricks -->

      <!-- the scaling center =!= part center -->
      <a-entity
        id="test"
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_0"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_1"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_2"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_3"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_4"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_5"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_6"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_7"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_8"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_9"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_10"
        mixin="pump"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3062b_dot_dat_instance_11"
        mixin="pump"
      ></a-entity>

      <!-- 4 walls -->
      <a-entity
        gltf-part="src: #bricks; part: Part-3001_dot_dat_instance_0"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3001_dot_dat_instance_1"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3001_dot_dat_instance_2"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-3001_dot_dat_instance_3"
      ></a-entity>

      <!-- big bricks -->
      <a-entity
        gltf-part="src: #bricks; part: Part-30144_dot_dat_instance_0"
      ></a-entity>
      <a-entity
        gltf-part="src: #bricks; part: Part-30144_dot_dat_instance_1"
      ></a-entity>
    </a-entity>
  </a-scene>
</body>
